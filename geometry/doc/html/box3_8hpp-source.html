<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>gtl: box3.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.4 -->
<div class="nav">
<a class="el" href="dir_562e9cdbb79a04f05979e49e3df4343e.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_a0362990858c4ab15dab14bdb5d60c61.html">gtl</a></div>
<h1>box3.hpp</h1><a href="box3_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">_______________________________________________________________________</span>
<a name="l00003"></a>00003 <span class="comment">__________________________ G E O M E T R Y ____________________________</span>
<a name="l00004"></a>00004 <span class="comment">|</span>
<a name="l00005"></a>00005 <span class="comment">| THIS FILE IS PART OF THE GEOMETRY TEMPLATE LIBRARY.</span>
<a name="l00006"></a>00006 <span class="comment">| USE, DISTRIBUTION AND REPRODUCTION OF THIS LIBRARY SOURCE IS     </span>
<a name="l00007"></a>00007 <span class="comment">| GOVERNED BY A BSD-STYLE SOURCE LICENSE.</span>
<a name="l00008"></a>00008 <span class="comment">| PLEASE READ THESE TERMS BEFORE DISTRIBUTING.       </span>
<a name="l00009"></a>00009 <span class="comment">_______________________________________________________________________</span>
<a name="l00010"></a>00010 <span class="comment">_______________________________________________________________________</span>
<a name="l00011"></a>00011 <span class="comment">*/</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#ifndef BOX3_H</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor">#define BOX3_H</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;<a class="code" href="gtl_8hpp.html">gtl/gtl.hpp</a>&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;<a class="code" href="vec3_8hpp.html">gtl/vec3.hpp</a>&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;<a class="code" href="ray_8hpp.html">gtl/ray.hpp</a>&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;<a class="code" href="plane_8hpp.html">gtl/plane.hpp</a>&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;<a class="code" href="matrix4_8hpp.html">gtl/matrix4.hpp</a>&gt;</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="keyword">namespace </span>gtl
<a name="l00023"></a>00023 {
<a name="l00024"></a>00024     <span class="comment">// forward declaration      </span>
<a name="l00025"></a>00025     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Type&gt; <span class="keyword">class </span>Plane;
<a name="l00026"></a>00026     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Type&gt; <span class="keyword">class </span>Ray;
<a name="l00027"></a>00027 
<a name="l00037"></a>00037     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Type&gt;
<a name="l00038"></a><a class="code" href="classgtl_1_1_box3.html">00038</a>     <span class="keyword">class </span><a class="code" href="classgtl_1_1_box3.html" title="Axis-Aligned 3D Bounding Box Class..">Box3</a>
<a name="l00039"></a>00039     {
<a name="l00040"></a>00040     <span class="keyword">public</span>:
<a name="l00042"></a><a class="code" href="classgtl_1_1_box3.html#17db0a317ca968129f493719576d4b2e">00042</a>         <a class="code" href="classgtl_1_1_box3.html#17db0a317ca968129f493719576d4b2e" title="The default constructor makes an empty box.">Box3</a>()
<a name="l00043"></a>00043         {
<a name="l00044"></a>00044             <a class="code" href="classgtl_1_1_box3.html#278bf446e06a66a31259830887d0b492" title="Marks this as an empty box.">makeEmpty</a>();
<a name="l00045"></a>00045         }
<a name="l00046"></a>00046 
<a name="l00048"></a><a class="code" href="classgtl_1_1_box3.html#0b8ded8cbc420a187dd4fec3fe068463">00048</a>         <a class="code" href="classgtl_1_1_box3.html#17db0a317ca968129f493719576d4b2e" title="The default constructor makes an empty box.">Box3</a>(<span class="keyword">const</span> <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> &amp; a_min, <span class="keyword">const</span> <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> &amp; a_max)
<a name="l00049"></a>00049         {
<a name="l00050"></a>00050             <a class="code" href="classgtl_1_1_box3.html#7754543599e07dde72524e17bd41385e" title="Reset the boundaries of the box with the given corners.">setBounds</a>(a_min, a_max);
<a name="l00051"></a>00051         }
<a name="l00052"></a>00052 
<a name="l00054"></a><a class="code" href="classgtl_1_1_box3.html#4b46a7859b5769ad4396a19f2390f544">00054</a>         <span class="keyword">virtual</span> <a class="code" href="classgtl_1_1_box3.html#4b46a7859b5769ad4396a19f2390f544" title="Default destructor does nothing.">~Box3</a>(){}
<a name="l00055"></a>00055 
<a name="l00057"></a><a class="code" href="classgtl_1_1_box3.html#7754543599e07dde72524e17bd41385e">00057</a>         <span class="keywordtype">void</span> <a class="code" href="classgtl_1_1_box3.html#7754543599e07dde72524e17bd41385e" title="Reset the boundaries of the box with the given corners.">setBounds</a>(<span class="keyword">const</span> <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> &amp; a_min, <span class="keyword">const</span> <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> &amp; a_max)
<a name="l00058"></a>00058         {
<a name="l00059"></a>00059             m_min = a_min;
<a name="l00060"></a>00060             m_max = a_max;
<a name="l00061"></a>00061         }
<a name="l00062"></a>00062 
<a name="l00064"></a><a class="code" href="classgtl_1_1_box3.html#8e04e96572307722c58e33b6949e27bd">00064</a>         <span class="keywordtype">bool</span> <a class="code" href="classgtl_1_1_box3.html#8e04e96572307722c58e33b6949e27bd" title="Check if this has been marked as an empty box.">isEmpty</a>()<span class="keyword"> const</span>
<a name="l00065"></a>00065 <span class="keyword">        </span>{
<a name="l00066"></a>00066             <span class="keywordflow">return</span> (m_max[0] &lt; m_min[0] || 
<a name="l00067"></a>00067                     m_max[1] &lt; m_min[1] ||
<a name="l00068"></a>00068                     m_max[2] &lt; m_min[2]);
<a name="l00069"></a>00069         }
<a name="l00070"></a>00070 
<a name="l00072"></a><a class="code" href="classgtl_1_1_box3.html#278bf446e06a66a31259830887d0b492">00072</a>         <span class="keywordtype">void</span> <a class="code" href="classgtl_1_1_box3.html#278bf446e06a66a31259830887d0b492" title="Marks this as an empty box.">makeEmpty</a>()
<a name="l00073"></a>00073         {
<a name="l00074"></a>00074             m_min =  <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;::max</a>();
<a name="l00075"></a>00075             m_max = -<a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;::max</a>();
<a name="l00076"></a>00076         }
<a name="l00077"></a>00077 
<a name="l00079"></a><a class="code" href="classgtl_1_1_box3.html#aa93c9f64d005f397f3f4649eb2a7f21">00079</a>         <span class="keyword">const</span> <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> &amp; <a class="code" href="classgtl_1_1_box3.html#aa93c9f64d005f397f3f4649eb2a7f21" title="Returns the lower left corner of the box.">getMin</a>()<span class="keyword"> const</span>
<a name="l00080"></a>00080 <span class="keyword">        </span>{ 
<a name="l00081"></a>00081             <span class="keywordflow">return</span> m_min; 
<a name="l00082"></a>00082         }
<a name="l00083"></a>00083 
<a name="l00085"></a><a class="code" href="classgtl_1_1_box3.html#1be6510af0be02662a96ee6de80f9d8e">00085</a>         <span class="keyword">const</span> <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> &amp; <a class="code" href="classgtl_1_1_box3.html#1be6510af0be02662a96ee6de80f9d8e" title="Returns the upper right corner of the box.">getMax</a>()<span class="keyword"> const</span>
<a name="l00086"></a>00086 <span class="keyword">        </span>{ 
<a name="l00087"></a>00087             <span class="keywordflow">return</span> m_max; 
<a name="l00088"></a>00088         }
<a name="l00089"></a>00089 
<a name="l00091"></a><a class="code" href="classgtl_1_1_box3.html#5159fd418c83cbe4ed8b62ada3de9a70">00091</a>         <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> <a class="code" href="classgtl_1_1_box3.html#5159fd418c83cbe4ed8b62ada3de9a70" title="Returns width, height and depth of box.">getSize</a>()<span class="keyword"> const</span>
<a name="l00092"></a>00092 <span class="keyword">        </span>{
<a name="l00093"></a>00093             <span class="keywordflow">return</span> m_max - m_min;
<a name="l00094"></a>00094         }
<a name="l00095"></a>00095 
<a name="l00097"></a><a class="code" href="classgtl_1_1_box3.html#a57144d88f913f2b93c51f47f8b40812">00097</a>         <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> <a class="code" href="classgtl_1_1_box3.html#a57144d88f913f2b93c51f47f8b40812" title="Returns the center point of the box.">getCenter</a>()<span class="keyword"> const</span>
<a name="l00098"></a>00098 <span class="keyword">        </span>{
<a name="l00099"></a>00099             <span class="keywordflow">return</span> <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a>((m_max[0] + m_min[0]) * 0.5f,
<a name="l00100"></a>00100                               (m_max[1] + m_min[1]) * 0.5f,
<a name="l00101"></a>00101                               (m_max[2] + m_min[2]) * 0.5f);
<a name="l00102"></a>00102         }
<a name="l00103"></a>00103 
<a name="l00105"></a><a class="code" href="classgtl_1_1_box3.html#17b15e701f364c87bb1a5023c0092d50">00105</a>         <span class="keywordtype">void</span> <a class="code" href="classgtl_1_1_box3.html#17b15e701f364c87bb1a5023c0092d50" title="Extend the boundaries of the box by the given point.">extendBy</a>(<span class="keyword">const</span> <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> &amp; a_point)
<a name="l00106"></a>00106         {
<a name="l00107"></a>00107             <span class="keywordflow">if</span>(<a class="code" href="classgtl_1_1_box3.html#8e04e96572307722c58e33b6949e27bd" title="Check if this has been marked as an empty box.">isEmpty</a>()){
<a name="l00108"></a>00108                 <a class="code" href="classgtl_1_1_box3.html#7754543599e07dde72524e17bd41385e" title="Reset the boundaries of the box with the given corners.">setBounds</a>(a_point, a_point);
<a name="l00109"></a>00109             }<span class="keywordflow">else</span>{
<a name="l00110"></a>00110                 <span class="keywordflow">if</span>(a_point[0] &lt; m_min[0]) m_min[0] = a_point[0];
<a name="l00111"></a>00111                 <span class="keywordflow">if</span>(a_point[1] &lt; m_min[1]) m_min[1] = a_point[1];
<a name="l00112"></a>00112                 <span class="keywordflow">if</span>(a_point[2] &lt; m_min[2]) m_min[2] = a_point[2];
<a name="l00113"></a>00113 
<a name="l00114"></a>00114                 <span class="keywordflow">if</span>(a_point[0] &gt; m_max[0]) m_max[0] = a_point[0];
<a name="l00115"></a>00115                 <span class="keywordflow">if</span>(a_point[1] &gt; m_max[1]) m_max[1] = a_point[1];
<a name="l00116"></a>00116                 <span class="keywordflow">if</span>(a_point[2] &gt; m_max[2]) m_max[2] = a_point[2];
<a name="l00117"></a>00117             }
<a name="l00118"></a>00118         }
<a name="l00119"></a>00119 
<a name="l00121"></a><a class="code" href="classgtl_1_1_box3.html#e54448dec89d390ae48d0e39cb6b589c">00121</a>         <span class="keywordtype">void</span> <a class="code" href="classgtl_1_1_box3.html#17b15e701f364c87bb1a5023c0092d50" title="Extend the boundaries of the box by the given point.">extendBy</a>(<span class="keyword">const</span> <a class="code" href="classgtl_1_1_box3.html" title="Axis-Aligned 3D Bounding Box Class..">Box3&lt;Type&gt;</a> &amp; a_box)
<a name="l00122"></a>00122         {
<a name="l00123"></a>00123             <span class="keywordflow">if</span>(<a class="code" href="classgtl_1_1_box3.html#8e04e96572307722c58e33b6949e27bd" title="Check if this has been marked as an empty box.">isEmpty</a>()){
<a name="l00124"></a>00124                 *<span class="keyword">this</span> = a_box;
<a name="l00125"></a>00125             }<span class="keywordflow">else</span>{
<a name="l00126"></a>00126                 <a class="code" href="classgtl_1_1_box3.html#17b15e701f364c87bb1a5023c0092d50" title="Extend the boundaries of the box by the given point.">extendBy</a>(a_box.<a class="code" href="classgtl_1_1_box3.html#aa93c9f64d005f397f3f4649eb2a7f21" title="Returns the lower left corner of the box.">getMin</a>());
<a name="l00127"></a>00127                 <a class="code" href="classgtl_1_1_box3.html#17b15e701f364c87bb1a5023c0092d50" title="Extend the boundaries of the box by the given point.">extendBy</a>(a_box.<a class="code" href="classgtl_1_1_box3.html#1be6510af0be02662a96ee6de80f9d8e" title="Returns the upper right corner of the box.">getMax</a>());
<a name="l00128"></a>00128             }
<a name="l00129"></a>00129         }
<a name="l00130"></a>00130 
<a name="l00132"></a><a class="code" href="classgtl_1_1_box3.html#d7a116424f9e77134c6ab2de3e7fe5cd">00132</a>         Type <a class="code" href="classgtl_1_1_box3.html#d7a116424f9e77134c6ab2de3e7fe5cd" title="Give the volume of the box (0 for an empty box).">getVolume</a>()<span class="keyword"> const</span>
<a name="l00133"></a>00133 <span class="keyword">        </span>{
<a name="l00134"></a>00134             <span class="keywordflow">if</span>(<a class="code" href="classgtl_1_1_box3.html#8e04e96572307722c58e33b6949e27bd" title="Check if this has been marked as an empty box.">isEmpty</a>()) <span class="keywordflow">return</span> 0.0;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136             <span class="keywordflow">return</span> (m_max[0] - m_min[0]) * (m_max[1] - m_min[1]) * (m_max[2] - m_min[2]);
<a name="l00137"></a>00137         }
<a name="l00138"></a>00138 
<a name="l00140"></a><a class="code" href="classgtl_1_1_box3.html#5050f16c880eec49f96bba75b376cf19">00140</a>         <span class="keywordtype">void</span> <a class="code" href="classgtl_1_1_box3.html#5050f16c880eec49f96bba75b376cf19" title="Transforms Box3 by matrix, enlarging Box3 to contain result.">transform</a>(<span class="keyword">const</span> <a class="code" href="classgtl_1_1_matrix4.html" title="Row-major 4x4 matrix class.">Matrix4&lt;Type&gt;</a> &amp; m)
<a name="l00141"></a>00141         {
<a name="l00142"></a>00142             <span class="comment">// a transformed empty box is still empty</span>
<a name="l00143"></a>00143             <span class="keywordflow">if</span>(<a class="code" href="classgtl_1_1_box3.html#8e04e96572307722c58e33b6949e27bd" title="Check if this has been marked as an empty box.">isEmpty</a>()) <span class="keywordflow">return</span>;
<a name="l00144"></a>00144 
<a name="l00145"></a>00145             <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> corners[8];
<a name="l00146"></a>00146             corners[0]    = m_min;
<a name="l00147"></a>00147             corners[1][0] = m_min[0]; corners[1][1] = m_max[1]; corners[1][2] = m_min[2];
<a name="l00148"></a>00148             corners[2][0] = m_max[0]; corners[2][1] = m_max[1]; corners[2][2] = m_min[2];
<a name="l00149"></a>00149             corners[3][0] = m_max[0]; corners[3][1] = m_min[1]; corners[3][2] = m_min[2];            
<a name="l00150"></a>00150             corners[4]    = m_max;
<a name="l00151"></a>00151             corners[5][0] = m_min[0]; corners[5][1] = m_max[1]; corners[5][2] = m_max[2];
<a name="l00152"></a>00152             corners[6][0] = m_min[0]; corners[6][1] = m_min[1]; corners[6][2] = m_max[2];
<a name="l00153"></a>00153             corners[7][0] = m_max[0]; corners[7][1] = m_min[1]; corners[7][2] = m_max[2];
<a name="l00154"></a>00154 
<a name="l00155"></a>00155             <a class="code" href="classgtl_1_1_box3.html" title="Axis-Aligned 3D Bounding Box Class..">Box3&lt;Type&gt;</a> newbox;
<a name="l00156"></a>00156             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 8; ++i){
<a name="l00157"></a>00157                 m.<a class="code" href="classgtl_1_1_matrix4.html#fc612fd837c6aacca2f96a7ab75df081" title="Multiplies given row vector by matrix, giving vector result.">multVecMatrix</a>(corners[i], corners[i]);
<a name="l00158"></a>00158                 newbox.<a class="code" href="classgtl_1_1_box3.html#17b15e701f364c87bb1a5023c0092d50" title="Extend the boundaries of the box by the given point.">extendBy</a>(corners[i]);
<a name="l00159"></a>00159             }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161             <a class="code" href="classgtl_1_1_box3.html#7754543599e07dde72524e17bd41385e" title="Reset the boundaries of the box with the given corners.">setBounds</a>(newbox.<a class="code" href="classgtl_1_1_box3.html#72dada47a6a23a2a08a3032a3246ff5b">m_min</a>, newbox.<a class="code" href="classgtl_1_1_box3.html#003b4ddfb7896b50ada3861850274aea">m_max</a>);
<a name="l00162"></a>00162         }
<a name="l00163"></a>00163 
<a name="l00165"></a><a class="code" href="classgtl_1_1_box3.html#3ef69cb73f04a73f7723c66500ae6170">00165</a>         <span class="keywordtype">bool</span> <a class="code" href="classgtl_1_1_box3.html#3ef69cb73f04a73f7723c66500ae6170" title="Check if a_point lies within the boundaries of this box.">intersect</a>(<span class="keyword">const</span> <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> &amp; a_point)<span class="keyword"> const</span>
<a name="l00166"></a>00166 <span class="keyword">        </span>{
<a name="l00167"></a>00167             <span class="keywordflow">return</span> !(a_point[0] &lt; m_min[0] || a_point[0] &gt; m_max[0] ||
<a name="l00168"></a>00168                      a_point[1] &lt; m_min[1] || a_point[1] &gt; m_max[1] ||
<a name="l00169"></a>00169                      a_point[2] &lt; m_min[2] || a_point[2] &gt; m_max[2]);
<a name="l00170"></a>00170         }
<a name="l00171"></a>00171 
<a name="l00173"></a><a class="code" href="classgtl_1_1_box3.html#5ef860377e427c06c17581f4f95fd6be">00173</a>         <span class="keywordtype">bool</span> <a class="code" href="classgtl_1_1_box3.html#3ef69cb73f04a73f7723c66500ae6170" title="Check if a_point lies within the boundaries of this box.">intersect</a>(<span class="keyword">const</span> <a class="code" href="classgtl_1_1_box3.html" title="Axis-Aligned 3D Bounding Box Class..">Box3&lt;Type&gt;</a> &amp; a_box)<span class="keyword"> const</span>
<a name="l00174"></a>00174 <span class="keyword">        </span>{
<a name="l00175"></a>00175             <span class="keywordflow">if</span> ((m_max[0] &lt; a_box.<a class="code" href="classgtl_1_1_box3.html#72dada47a6a23a2a08a3032a3246ff5b">m_min</a>[0]) || (m_min[0] &gt; a_box.<a class="code" href="classgtl_1_1_box3.html#003b4ddfb7896b50ada3861850274aea">m_max</a>[0]) ||
<a name="l00176"></a>00176                 (m_max[1] &lt; a_box.<a class="code" href="classgtl_1_1_box3.html#72dada47a6a23a2a08a3032a3246ff5b">m_min</a>[1]) || (m_min[1] &gt; a_box.<a class="code" href="classgtl_1_1_box3.html#003b4ddfb7896b50ada3861850274aea">m_max</a>[1]) ||
<a name="l00177"></a>00177                 (m_max[2] &lt; a_box.<a class="code" href="classgtl_1_1_box3.html#72dada47a6a23a2a08a3032a3246ff5b">m_min</a>[2]) || (m_min[2] &gt; a_box.<a class="code" href="classgtl_1_1_box3.html#003b4ddfb7896b50ada3861850274aea">m_max</a>[2])){
<a name="l00178"></a>00178                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00179"></a>00179             }
<a name="l00180"></a>00180             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00181"></a>00181         }
<a name="l00182"></a>00182 
<a name="l00184"></a><a class="code" href="classgtl_1_1_box3.html#2a3cd0d0488f500b6f1c6e1f5bb05298">00184</a>         <span class="keywordtype">bool</span> <a class="code" href="classgtl_1_1_box3.html#3ef69cb73f04a73f7723c66500ae6170" title="Check if a_point lies within the boundaries of this box.">intersect</a>(<span class="keyword">const</span> <a class="code" href="classgtl_1_1_ray.html" title="Represents a directed ray in 3D.">Ray&lt;Type&gt;</a> &amp; a_ray, Type &amp; tmin, Type &amp; tmax)<span class="keyword"> const</span>
<a name="l00185"></a>00185 <span class="keyword">        </span>{
<a name="l00186"></a>00186             <span class="comment">// Amy Williams, Steve Barrus, R. Keith Morley, and Peter Shirley</span>
<a name="l00187"></a>00187             <span class="comment">// "An Efficient and Robust Ray-Box Intersection Algorithm"</span>
<a name="l00188"></a>00188             <span class="comment">//  Journal of graphics tools, 10(1):49-54, 2005</span>
<a name="l00189"></a>00189             <span class="keywordflow">if</span>( <a class="code" href="classgtl_1_1_box3.html#8e04e96572307722c58e33b6949e27bd" title="Check if this has been marked as an empty box.">isEmpty</a>() ) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191             <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> inv_direction(1/a_ray.<a class="code" href="classgtl_1_1_ray.html#2ebf1297a825b356a2c7f2a9e114aac1" title="Return the ray normalized direction.">getDirection</a>()[0], 1/a_ray.<a class="code" href="classgtl_1_1_ray.html#2ebf1297a825b356a2c7f2a9e114aac1" title="Return the ray normalized direction.">getDirection</a>()[1], 1/a_ray.<a class="code" href="classgtl_1_1_ray.html#2ebf1297a825b356a2c7f2a9e114aac1" title="Return the ray normalized direction.">getDirection</a>()[2]);
<a name="l00192"></a>00192 
<a name="l00193"></a>00193             <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;int&gt;</a> <a class="code" href="namespacegtl.html#ca32d9afb268bab546337dca1d9a6e45">sign</a>( inv_direction[0] &lt; 0, inv_direction[1] &lt; 0, inv_direction[2] &lt; 0);
<a name="l00194"></a>00194 
<a name="l00195"></a>00195             tmin  = ((sign[0] ? m_max : m_min).x() - a_ray.<a class="code" href="classgtl_1_1_ray.html#454f0cc367cbb69adc28868d52bf9cea" title="Return the ray origin.">getOrigin</a>().x()) * inv_direction.x();
<a name="l00196"></a>00196             tmax  = (((1-sign[0]) ? m_max : m_min).x() - a_ray.<a class="code" href="classgtl_1_1_ray.html#454f0cc367cbb69adc28868d52bf9cea" title="Return the ray origin.">getOrigin</a>().x()) * inv_direction.x();
<a name="l00197"></a>00197 
<a name="l00198"></a>00198             Type tymin = ((sign[1] ? m_max : m_min).y() - a_ray.<a class="code" href="classgtl_1_1_ray.html#454f0cc367cbb69adc28868d52bf9cea" title="Return the ray origin.">getOrigin</a>().y()) * inv_direction.y();
<a name="l00199"></a>00199             Type tymax = (((1-sign[1]) ? m_max : m_min).y() - a_ray.<a class="code" href="classgtl_1_1_ray.html#454f0cc367cbb69adc28868d52bf9cea" title="Return the ray origin.">getOrigin</a>().y()) * inv_direction.y();
<a name="l00200"></a>00200 
<a name="l00201"></a>00201             <span class="keywordflow">if</span>( (tmin &gt; tymax) || (tymin &gt; tmax) ) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00202"></a>00202 
<a name="l00203"></a>00203             <span class="keywordflow">if</span>(tymin &gt; tmin) tmin = tymin;
<a name="l00204"></a>00204             <span class="keywordflow">if</span>(tymax &lt; tmax) tmax = tymax;
<a name="l00205"></a>00205 
<a name="l00206"></a>00206             Type tzmin = ((sign[2] ? m_max : m_min).z() - a_ray.<a class="code" href="classgtl_1_1_ray.html#454f0cc367cbb69adc28868d52bf9cea" title="Return the ray origin.">getOrigin</a>().z()) * inv_direction.z();
<a name="l00207"></a>00207             Type tzmax = (((1-sign[2]) ? m_max : m_min).z() - a_ray.<a class="code" href="classgtl_1_1_ray.html#454f0cc367cbb69adc28868d52bf9cea" title="Return the ray origin.">getOrigin</a>().z()) * inv_direction.z();
<a name="l00208"></a>00208 
<a name="l00209"></a>00209             <span class="keywordflow">if</span>( (tmin &gt; tzmax) || (tzmin &gt; tmax) ) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00210"></a>00210 
<a name="l00211"></a>00211             <span class="keywordflow">if</span> (tzmin &gt; tmin) tmin = tzmin;
<a name="l00212"></a>00212             <span class="keywordflow">if</span> (tzmax &lt; tmax) tmax = tzmax;
<a name="l00213"></a>00213 
<a name="l00214"></a>00214             <span class="keywordflow">return</span> (tmin &gt;= 0 &amp;&amp; tmax &gt;= 1);
<a name="l00215"></a>00215         }
<a name="l00216"></a>00216 
<a name="l00218"></a><a class="code" href="classgtl_1_1_box3.html#61a922a170c96fed06ad47c6c023724f">00218</a>         <span class="keywordtype">bool</span> <a class="code" href="classgtl_1_1_box3.html#3ef69cb73f04a73f7723c66500ae6170" title="Check if a_point lies within the boundaries of this box.">intersect</a>(<span class="keyword">const</span> <a class="code" href="classgtl_1_1_plane.html" title="Represents an oriented plane in 3D.">Plane&lt;Type&gt;</a> &amp; a_plane)<span class="keyword"> const</span>
<a name="l00219"></a>00219 <span class="keyword">        </span>{
<a name="l00220"></a>00220             <span class="comment">// Empty boxes can cause problems.</span>
<a name="l00221"></a>00221             <span class="keywordflow">if</span>( <a class="code" href="classgtl_1_1_box3.html#8e04e96572307722c58e33b6949e27bd" title="Check if this has been marked as an empty box.">isEmpty</a>() ) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00222"></a>00222 
<a name="l00223"></a>00223             <span class="keyword">const</span> <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> &amp; pnorm = a_plane.<a class="code" href="classgtl_1_1_plane.html#330ca394954f1e5f31d841aba6e083a4" title="Return the plane&amp;#39;s normal vector.">getNormal</a>();
<a name="l00224"></a>00224 
<a name="l00225"></a>00225             <span class="comment">// Use separating axis theorem to test overlap.</span>
<a name="l00226"></a>00226             <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> <a class="code" href="namespacegtl.html#5afed63a2592f499d71127a98c17f5b5">min3</a>( pnorm[0] &gt; 0.0 ? m_min[0] : m_max[0],
<a name="l00227"></a>00227                              pnorm[1] &gt; 0.0 ? m_min[1] : m_max[1],
<a name="l00228"></a>00228                              pnorm[2] &gt; 0.0 ? m_min[2] : m_max[2]);
<a name="l00229"></a>00229 
<a name="l00230"></a>00230             <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> <a class="code" href="namespacegtl.html#8c8dea3e50586a678f70ee91e8eaa3eb">max3</a>( pnorm[0] &gt; 0.0 ? m_max[0] : m_min[0],
<a name="l00231"></a>00231                              pnorm[1] &gt; 0.0 ? m_max[1] : m_min[1],
<a name="l00232"></a>00232                              pnorm[2] &gt; 0.0 ? m_max[2] : m_min[2]);
<a name="l00233"></a>00233 
<a name="l00234"></a>00234             <span class="keywordflow">if</span>(a_plane.<a class="code" href="classgtl_1_1_plane.html#f8506400805e9493f17cad5c28863b60" title="Check if the given point lies in the halfspace of the plane which the plane normal...">isInHalfSpace</a>(vmin)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00235"></a>00235             <span class="keywordflow">if</span>(a_plane.<a class="code" href="classgtl_1_1_plane.html#f8506400805e9493f17cad5c28863b60" title="Check if the given point lies in the halfspace of the plane which the plane normal...">isInHalfSpace</a>(vmax)) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00236"></a>00236 
<a name="l00237"></a>00237             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00238"></a>00238         }
<a name="l00239"></a>00239 
<a name="l00241"></a><a class="code" href="classgtl_1_1_box3.html#c76f027eae16289a7f874751d81ae897">00241</a>         <span class="keyword">friend</span> <span class="keywordtype">bool</span> <a class="code" href="classgtl_1_1_box3.html#c76f027eae16289a7f874751d81ae897" title="Check b1 and b2 for equality.">operator ==</a>(<span class="keyword">const</span> <a class="code" href="classgtl_1_1_box3.html" title="Axis-Aligned 3D Bounding Box Class..">Box3&lt;Type&gt;</a> &amp; b1, <span class="keyword">const</span> <a class="code" href="classgtl_1_1_box3.html" title="Axis-Aligned 3D Bounding Box Class..">Box3&lt;Type&gt;</a> &amp; b2)
<a name="l00242"></a>00242         { 
<a name="l00243"></a>00243             <span class="keywordflow">return</span> b1.<a class="code" href="classgtl_1_1_box3.html#aa93c9f64d005f397f3f4649eb2a7f21" title="Returns the lower left corner of the box.">getMin</a>() == b2.<a class="code" href="classgtl_1_1_box3.html#aa93c9f64d005f397f3f4649eb2a7f21" title="Returns the lower left corner of the box.">getMin</a>() &amp;&amp; b1.<a class="code" href="classgtl_1_1_box3.html#1be6510af0be02662a96ee6de80f9d8e" title="Returns the upper right corner of the box.">getMax</a>() == b2.<a class="code" href="classgtl_1_1_box3.html#1be6510af0be02662a96ee6de80f9d8e" title="Returns the upper right corner of the box.">getMax</a>(); 
<a name="l00244"></a>00244         }
<a name="l00245"></a>00245 
<a name="l00247"></a><a class="code" href="classgtl_1_1_box3.html#b6a7d1c76fe045908425ab5bf50782f0">00247</a>         <span class="keyword">friend</span> <span class="keywordtype">bool</span> <a class="code" href="classgtl_1_1_box3.html#b6a7d1c76fe045908425ab5bf50782f0" title="Check b1 and b2 for inequality.">operator !=</a>(<span class="keyword">const</span> <a class="code" href="classgtl_1_1_box3.html" title="Axis-Aligned 3D Bounding Box Class..">Box3&lt;Type&gt;</a> &amp; b1, <span class="keyword">const</span> <a class="code" href="classgtl_1_1_box3.html" title="Axis-Aligned 3D Bounding Box Class..">Box3&lt;Type&gt;</a> &amp; b2)
<a name="l00248"></a>00248         { 
<a name="l00249"></a>00249             <span class="keywordflow">return</span> !(b1 == b2); 
<a name="l00250"></a>00250         }
<a name="l00251"></a>00251 
<a name="l00252"></a>00252     <span class="keyword">private</span>:
<a name="l00253"></a>00253         <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> m_min;
<a name="l00254"></a>00254         <a class="code" href="classgtl_1_1_vec3.html" title="3 dimensional vector.">Vec3&lt;Type&gt;</a> m_max;
<a name="l00255"></a>00255     };
<a name="l00256"></a>00256 
<a name="l00257"></a><a class="code" href="namespacegtl.html#e2a82fa00d4ae9badc3a31a32a738b8f">00257</a>     <span class="keyword">typedef</span> <a class="code" href="classgtl_1_1_box3.html" title="Axis-Aligned 3D Bounding Box Class..">Box3&lt;int&gt;</a>    <a class="code" href="classgtl_1_1_box3.html" title="Axis-Aligned 3D Bounding Box Class..">Box3i</a>;
<a name="l00258"></a><a class="code" href="namespacegtl.html#7171fb66596e8c9f93fd738a716d2f2a">00258</a>     <span class="keyword">typedef</span> <a class="code" href="classgtl_1_1_box3.html" title="Axis-Aligned 3D Bounding Box Class..">Box3&lt;float&gt;</a>  <a class="code" href="classgtl_1_1_box3.html" title="Axis-Aligned 3D Bounding Box Class..">Box3f</a>;
<a name="l00259"></a><a class="code" href="namespacegtl.html#5353754982f33571cc6f260d8ca869db">00259</a>     <span class="keyword">typedef</span> <a class="code" href="classgtl_1_1_box3.html" title="Axis-Aligned 3D Bounding Box Class..">Box3&lt;double&gt;</a> <a class="code" href="classgtl_1_1_box3.html" title="Axis-Aligned 3D Bounding Box Class..">Box3d</a>;
<a name="l00260"></a>00260 } <span class="comment">// namespace gtl</span>
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="text-align: right;"><small>Generated on Sun Feb 3 23:32:45 2008 for gtl by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.4 </small></address>
</body>
</html>
